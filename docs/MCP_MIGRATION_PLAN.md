# MCPサーバー移行計画

## 1. 移行の目的と概要

- 新しい設定管理システムへの統一
- Docker化による環境の標準化
- 運用管理の効率化

## 2. 移行対象サーバー

### フェーズ1: 基本インフラストラクチャ（2週間）
- [x] SQLite: 完了
- [ ] PostgreSQL: データベース操作の基盤
- [ ] Filesystem: ファイル操作の基盤
- [ ] Memory: 知識グラフベースの永続メモリシステム

### フェーズ2: 開発支援ツール（2週間）
- [ ] Git: リポジトリ操作
- [ ] GitHub: GitHub API連携
- [ ] GitLab: GitLab API連携
- [ ] Puppeteer: ブラウザ自動化

### フェーズ3: 外部サービス連携（2週間）
- [ ] Google Drive: ファイルアクセス
- [ ] Google Maps: 位置情報サービス
- [ ] Slack: チャネル管理
- [ ] Sentry: エラー追跡

### フェーズ4: 特殊機能（2週間）
- [ ] EverArt: AI画像生成
- [ ] Sequential Thinking: 思考プロセス
- [ ] Time: 時間管理
- [ ] Everything: リファレンス/テスト

## 3. 移行手順の標準化

### 3.1 準備フェーズ
1. サーバーコードの分析
2. 依存関係の確認
3. 設定ファイルの準備
   - env.jsonの環境変数追加
   - development.jsonの設定追加

### 3.2 Docker化
1. Dockerfileの作成
   - ベースイメージの選択
   - 依存パッケージのインストール
   - 設定ファイルのコピー
2. docker-build.ps1の作成
3. ビルドテスト

### 3.3 設定移行
1. 新しい設定形式への変換
2. 環境変数の標準化
3. パスの相対化

### 3.4 テストと検証
1. 基本機能テスト
2. 権限テスト
3. エラーハンドリングテスト

## 4. リスク管理

### 4.1 想定されるリスク
- 依存関係の競合
- パス解決の問題
- 権限設定の不整合
- データの整合性

### 4.2 対策
- 段階的な移行による影響範囲の制限
- バックアップと復元手順の整備
- ロールバック手順の準備
- 監視体制の強化

## 5. スケジュール

### 5.1 全体スケジュール
- 総期間: 8週間
- 各フェーズ: 2週間
- バッファ: 1週間

### 5.2 マイルストーン
1. フェーズ1完了: 基本インフラの移行
2. フェーズ2完了: 開発ツールの移行
3. フェーズ3完了: 外部サービスの移行
4. フェーズ4完了: 特殊機能の移行

## 6. 監視と報告

### 6.1 監視項目
- 移行進捗状況
- エラー発生率
- パフォーマンス指標
- ユーザー影響度

### 6.2 報告体制
- 週次進捗報告
- 問題発生時の即時報告
- 完了報告書の作成

## 7. 運用ガイドライン

### 7.1 新規追加された運用ルール
- 設定変更時は必ずgenerate-config.ps1を実行
- 環境変数は必ずenv.jsonで管理
- パスの指定は環境変数を使用

### 7.2 移行後の確認事項
- 設定ファイルの生成状況
- 環境変数の解決結果
- サーバーの動作状況

## 8. 参考情報

### 8.1 重要なファイル
- MCP/config/env.json: 環境変数定義
- MCP/config/base.json: 基本設定テンプレート
- MCP/config/development.json: 開発環境設定
- MCP/config/generate-config.ps1: 設定生成スクリプト

### 8.2 関連ドキュメント
- MCPフレームワーク仕様書: docs/references/mcp_llm_reference.txt
- Docker公式ドキュメント: https://docs.docker.com/